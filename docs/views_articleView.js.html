

<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> views/articleView.js</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    Documentation
                </a>
                
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Modules</h3><ul><li><a href="module-App.html">App</a></li><li><a href="module-index.html">index</a></li><li><a href="module-store.html">store</a></li></ul></div><div class="category"><h2>Components</h2><h3>Modules</h3><ul><li><a href="module-DataTable.html">DataTable</a></li><li><a href="module-FormField.html">FormField</a></li><li><a href="module-Modal.html">Modal</a></li><li><a href="module-NavBar.html">NavBar</a></li><li><a href="module-SearchBar.html">SearchBar</a></li><li><a href="module-Tooltip.html">Tooltip</a></li></ul></div><div class="category"><h2>Models</h2><h3>Classes</h3><ul><li><a href="Article.html">Article</a></li><li><a href="ArticleInfo.html">ArticleInfo</a></li><li><a href="Country.html">Country</a></li><li><a href="Customer.html">Customer</a></li><li><a href="DetailOrder.html">DetailOrder</a></li><li><a href="Family.html">Family</a></li><li><a href="Order.html">Order</a></li><li><a href="Provider.html">Provider</a></li><li><a href="Vat.html">Vat</a></li></ul></div><div class="category"><h2>Services</h2><h3>Modules</h3><ul><li><a href="module-articleServices.html">articleServices</a></li><li><a href="module-toastsServices.html">toastsServices</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Source</p>
                    <h1>views/articleView.js</h1>
                </header>
                



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import "../style/item-view.scss";
import React, { useState } from "react";
import { TextField, NumberField, SelectField } from '../components/formField.js';
import Modal from '../components/modal.js';
import { Link } from "react-router-dom";
import { updateArticle, createArticle } from "../services/articleServices";
import { successDelete, errorToast, successUpdate, successAdd } from "../services/toastsServices";
import { Article } from "../classes/models/article.js";

/**
 * Article view
 * @category Views
 * @param {props} props
 * @returns The JSX code for the article view
 */
export default function ArticleView(props) {

  const { removeModal, categories, type, data } = props;

  // Article state
  const [article, setArticle] = useState({
    description: data.description,
    sold_price: data.sold_price,
    wholesale_price: data.wholesale_price,
    family: data.family,
    stock: data.stock,
    quantity_min: data.quantity_min,
    quantity_provided: data.quantity_provided,
    tax_id: data.tax_id
  });

  // Add article
  async function addArticle() {
    var nArticle = article;
    nArticle.description = nArticle.description.trim()
    nArticle.creation_date = new Date().toISOString().slice(0, 10); // Format : YYYY-MM-DD
    nArticle.id = "000000";

    const errors = Article.getErrors(article);

    if (errors.length > 0) {
      errors.forEach(error => errorToast(error));
      return;
    }

    
    createArticle(nArticle).then(
      (response) => {

        removeModal();

        switch (response.status) {
          case 201:
            successAdd();
            break;
          case 400:
            errorToast("An error occured while adding the article");
            break;
          default:
            errorToast("An error occured while adding the article");
            break;
        }
      }
    )
  }

  // Modify article
  async function modifyArticle() {
    var nArticle = article;
    nArticle.description = nArticle.description.trim()
    nArticle.id = data.id;

    const errors = Article.getErrors(article);

    if (errors.length > 0) {
      errors.forEach(error => errorToast(error));
      return;
    }

    updateArticle(nArticle).then(
      (response) => {
          removeModal();
  
          switch (response.status) {
            case 204:
              successUpdate();
              break;
            case 400:
              errorToast("An error occured while updating the article");
              break;
            default:
              errorToast("An error occured while updating the article");
              break;
          }
        }
    )

  }


  // Delete article
  function deleteArticle() {
    removeModal();
    successDelete();
  }

  return (
    &lt;Modal>
      &lt;div id="modify-view">
        &lt;h1 id="section-title">{type === "adding" ? "Add" : "Modify"} article&lt;/h1>

        &lt;div
          id="black-back"
          onClick={() => {
            removeModal();
          }}
        />

        &lt;div style={{ width: "80%" }}>

          &lt;div className="field-line">

            &lt;TextField
              for="description"
              label="Description"
              value={data.description}
              tooltip={&lt;>A description of the article. &lt;br>&lt;/br> Can't be empty&lt;/>}
              onChange={(e) => {
                setArticle(prevState => ({
                  ...prevState,
                  description: e.target.value
                }))
              }}
            />

            &lt;SelectField
              for="family"
              label="Family"
              value={data.family}
              options={categories}
              tooltip={&lt;>To add a family, go to the &lt;Link className="link" to='/families'>Manage families&lt;/Link> page&lt;/>}
              onChange={(e) => {
                setArticle(prevState => ({
                  ...prevState,
                  family: e.target.value
                }))
              }}
            />

          &lt;/div>

          &lt;div className="field-line">

            &lt;NumberField
              for="sold_price"
              label="Sold price"
              value={data.sold_price}
              tooltip={&lt;>Must be a positive number with two decimals &lt;b> Example: &lt;/b> 12.34&lt;/>}
              min="0"
              step="0.01"
              max="9999999"
              regex={/\d+\.\d{2}/}
              onChange={(e) => {
                setArticle(prevState => ({
                  ...prevState,
                  sold_price: e.target.value
                }))
              }}
            />

            {&lt;NumberField
              for="wholesale_price"
              label="Wholesale price"
              value={data.wholesale_price}
              tooltip={&lt;>Sum of a given product's cost price plus the manufacturer's profit margin&lt;br>&lt;/br>Must be a positive number with two decimals &lt;b> Example: &lt;/b> 12.34&lt;/>}
              min="0"
              step="0.01"
              max="9999999"
              regex={/\d+\.\d{2}/}
              onChange={(e) => {
                setArticle(prevState => ({
                  ...prevState,
                  wholesale_price: e.target.value
                }))
              }}
            />}

            &lt;SelectField
              for="tax_id"
              label="Tax"
              value={data.tax_id}
              options={[{ id: 1, name: "TVA 20%" }, { id: 2, name: "TVA 10%" }]}
              tooltip={&lt;>To add a tax, go to the &lt;Link className="link" to='/taxes'>Manage taxes&lt;/Link> page&lt;/>}
              onChange={(e) => {
                setArticle(prevState => ({
                  ...prevState,
                  tax_id: e.target.value
                }))
              }}
            />
          &lt;/div>

          &lt;div className="field-line">

            &lt;NumberField
              for="stock"
              label="Quantity in stock"
              value={data.stock}
              tooltip="Must be a positive or null integer"
              min="0"
              step="1"
              regex={/^\+?(0|[1-9]\d*)$/}
              onChange={(e) => {
                setArticle(prevState => ({
                  ...prevState,
                  stock: e.target.value
                }))
              }}
            />

            &lt;NumberField
              for="quantity_min"
              label="Quantity minimum"
              value={data.quantity_min}
              tooltip={&lt;>The minimum quantity that a customer can order. &lt;br>&lt;/br> Must be positive or null&lt;/>}
              min="0"
              step="1"
              regex={/^\+?(0|[1-9]\d*)$/}
              onChange={(e) => {
                setArticle(prevState => ({
                  ...prevState,
                  quantity_min: e.target.value
                }))
              }}
            />

            &lt;NumberField
              for="quantity_provided"
              label="Quantity provided"
              value={data.quantity_provided}
              tooltip="Must be a positive or null integer"
              min="0"
              step="1"
              regex={/^\+?(0|[1-9]\d*)$/}
              onChange={(e) => {
                setArticle(prevState => ({
                  ...prevState,
                  quantity_provided: e.target.value
                }))
              }}
            />
          &lt;/div>
        &lt;/div>

        &lt;div className="modify-buttons-list">

          &lt;button className="modify-button save-button" onClick={() => {
            if (type === "adding") {
              if (window.confirm("Are you sure you want to add this article ?")) {
                addArticle()
              }
            } else {
              if (window.confirm("Are you sure you want to save changes ?")) {
                modifyArticle()
              }
            }
          }}>{type === "adding" ? "Add article" : "Save changes"}&lt;/button>

          {type === "adding" ?
            &lt;button className="modify-button cancel-button" onClick={() => {
              if (window.confirm("Are you sure you want to cancel ?")) {
                removeModal()
              }
            }}>Cancel&lt;/button>
            :
            &lt;button className="modify-button delete-button" onClick={() => {
              if (window.confirm("Are you sure you want to delete this article ?")) {
                deleteArticle()
              }
            }}>Delete article&lt;/button>
          }

        &lt;/div>

      &lt;/div>
    &lt;/Modal>
  );
}</code></pre>
        </article>
    </section>




            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>


</body>
</html>
