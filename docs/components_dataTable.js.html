

<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> components/dataTable.js</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    Documentation
                </a>
                
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Modules</h3><ul><li><a href="module-App.html">App</a></li><li><a href="module-index.html">index</a></li><li><a href="module-store.html">store</a></li></ul></div><div class="category"><h2>Components</h2><h3>Modules</h3><ul><li><a href="module-DataTable.html">DataTable</a></li><li><a href="module-FormField.html">FormField</a></li><li><a href="module-Modal.html">Modal</a></li><li><a href="module-NavBar.html">NavBar</a></li><li><a href="module-SearchBar.html">SearchBar</a></li><li><a href="module-Tooltip.html">Tooltip</a></li></ul></div><div class="category"><h2>Models</h2><h3>Classes</h3><ul><li><a href="Article.html">Article</a></li><li><a href="ArticleInfo.html">ArticleInfo</a></li><li><a href="Country.html">Country</a></li><li><a href="Customer.html">Customer</a></li><li><a href="DetailOrder.html">DetailOrder</a></li><li><a href="Family.html">Family</a></li><li><a href="Order.html">Order</a></li><li><a href="Provider.html">Provider</a></li><li><a href="Vat.html">Vat</a></li></ul></div><div class="category"><h2>Services</h2><h3>Modules</h3><ul><li><a href="module-articleServices.html">articleServices</a></li><li><a href="module-toastsServices.html">toastsServices</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Source</p>
                    <h1>components/dataTable.js</h1>
                </header>
                



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useEffect, useState } from "react";
import "../style/data-table.scss";
import store from "../store";

// Enum for the sort directions
const sortTypes = {
    asc: -1,
    desc: 1
}

/**
 * @module DataTable
 * @category Components
 * @description - This component is used to display a table of data.
 * @param {Object} props - The props object containing the data, the columns, the onRowClick function and the maxResults.
 */
function DataTable(props) {

    // Props
    const { columns, onRowClick, maxResults } = props;

    // States
    const [data, setData] = useState(props.data);
    const [currentSort, setCurrentSort] = useState({ column: columns[0].name, direction: sortTypes.desc });
    const [currentPage, setCurrentPage] = useState(1);

    // Make the data reload when the search term changes
    useEffect(() => {
        setData(props.data);
        setCurrentPage(1);
    }, [props.data]);

    store.subscribe(() => {
        setData(store.getState().articles);
    });

    // Redirect to the item page when clicking on a row
    function handleRowClick(id) {
        onRowClick(id);
    }

    /**
     * @function nbResults - Display the number of results
     * @returns {String} - The number of results
     */
    function nbResults() {
        if (data.length === 0) {
            return "No results";
        }
        else if (data.length > 1) {
            return data.length + " correspondances";
        } else {
            return "1 correspondance";
        }
    }

    /**
     * @function displayColumns - Display the headers of the data table
     * @returns {JSX} - The JSX code for the headers of the data table
     */
    function displayColumns() {
        const columnsToDisplay = columns.filter(c => c.display)
        return (
            &lt;thead>
                &lt;tr>
                    {columnsToDisplay.map((column) => (
                        &lt;th className={column.type} onClick={() => sortData(column.name)} key={column.id}>
                            &lt;div style={{ display: "flex", flexDirection: "row", alignItems: "center" }}>
                                {column.displayName}
                                {currentSort.column === column.name &amp;&amp; currentSort.direction === sortTypes.desc &amp;&amp; &lt;p style={{ margin: "0px", marginLeft: "5px" }}>▼&lt;/p>}
                                {currentSort.column === column.name &amp;&amp; currentSort.direction === sortTypes.asc &amp;&amp; &lt;p style={{ margin: "0px", marginLeft: "5px" }}>▲&lt;/p>}
                            &lt;/div>
                        &lt;/th>
                    ))}
                &lt;/tr>
            &lt;/thead>
        );
    }


    /**
     * @function displayData - Display the data of the data table
     * @param {Array} items - The data to display
     * @returns {JSX} - The JSX code for the data table body
     */
    function displayData(items) {

        // Display only the items that are on the current page
        const displayedItems = items.slice((currentPage - 1) * maxResults, (currentPage - 1) * maxResults + maxResults)

        /**
         * @function
         * @description - Format the cell according to the type of the column
         * @param {number} key 
         * @param {string} value 
         * @returns {JSX} - The JSX code for the cell
         */
        function formatCell(key, value) {
            const column = columns.find((column) => column.name === key);
            switch (column.type) {
                case "price":
                    return &lt;td style={{ textAlign: "end" }} key={key}>{formatNumber(value)} €&lt;/td>;
                case "date":
                    return &lt;td key={key}>{formatDate(value)}&lt;/td>;
                default:
                    return &lt;td key={key}>{value}&lt;/td>;
            }
        }

        return (
            &lt;tbody>
                {displayedItems.map((item) => (
                    &lt;tr key={item.id} onClick={() => handleRowClick(item.id)}>
                        {
                            // Display only the columns that have the display property on TRUE and that are not the id
                            Object.entries(item)
                                .filter(([key]) => key !== "id")
                                .filter(([key]) => columns.find((column) => column.name === key).display)
                                .map(([key, value]) => formatCell(key, value))
                        }
                    &lt;/tr>
                ))}
            &lt;/tbody>
        );
    }

    /**
     * @function sortData - Sort the data according to the column
     * @param {string} column 
     * @returns {void}
     */  
    function sortData(column) {

        var sort = {};
        sort.column = column;
        sort.direction = currentSort.direction === sortTypes.asc ? sortTypes.desc : sortTypes.asc;

        // Sort the data according to the column type
        const sortedData = [...data].sort((a, b) => {

            if (column.type === "date") {
                return (new Date(a[sort.column]) - new Date(b[sort.column])) * sort.direction * -1;
            }
            switch (typeof a[sort.column]) {
                case "string":
                    return a[sort.column].localeCompare(b[sort.column]) * sort.direction;
                case "number":
                    return (a[sort.column] - b[sort.column]) * sort.direction * -1;
                default:
                    return 0;
            }
        });

        setCurrentSort(sort);
        setData(sortedData)
    }


    return (
        &lt;div>
            &lt;p id="search-results-text">{nbResults()}&lt;/p>
            &lt;table>
                {displayColumns()}
                {displayData(data)}
            &lt;/table>
            &lt;div id="table-footer">&lt;/div>
            &lt;br>&lt;/br>
            &lt;div id="buttons-page-container">

                &lt;p>Showing {(currentPage - 1) * maxResults + 1}-{currentPage &lt; Math.ceil(data.length / maxResults) ? (currentPage - 1) * maxResults + maxResults : data.length} out of {data.length} results&lt;/p>

                &lt;button className="button-page" onClick={() => {
                    if (currentPage > 1)
                        setCurrentPage(currentPage - 1)
                }}>Previous page&lt;/button>
                &lt;button className="button-page" onClick={() => {
                    if (currentPage &lt; Math.ceil(data.length / maxResults))
                        setCurrentPage(currentPage + 1)
                }}>Next page&lt;/button>
            &lt;/div>
        &lt;/div>
    );
}

function formatNumber(num) {
    if (typeof num !== 'number') {
        return '';
    }

    var str = num.toString().replace(/[\s,]/g, '');

    if (str.charAt(0) === '.') {
        str = '0' + str;
    }

    var parts = str.split('.');
    var integerPart = parts[0];
    var decimalPart = parts.length > 1 ? '.' + parts[1] : '.00';

    integerPart = integerPart.replace(/\B(?=(\d{3})+(?!\d))/g, ' ');

    if (decimalPart.length > 3) {
        decimalPart = parseFloat(decimalPart).toFixed(2);
    } else if (decimalPart.length === 2) {
        decimalPart += '0';
    }

    return integerPart + decimalPart;
}


function formatDate(isoDate) {
    const now = new Date();
    const date = new Date(isoDate);

    const delta = now - date;

    if (delta &lt; 0) {
        return "In the future";
    }

    if (delta &lt; 60 * 1000) {
        return "Just now";
    }
    if (delta &lt; 60 * 60 * 1000) {
        const minutes = Math.floor(delta / (60 * 1000));
        return `${minutes} minute${minutes > 1 ? "s" : ""} ago`;
    }
    else if (delta &lt; 24 * 60 * 60 * 1000) {
        const hours = Math.floor(delta / (60 * 60 * 1000));
        return `${hours} hour${hours > 1 ? "s" : ""} ago`;
    }
    else if (delta &lt; 30 * 24 * 60 * 60 * 1000) {
        const days = Math.floor(delta / (24 * 60 * 60 * 1000));
        return `${days} day${days > 1 ? "s" : ""} ago`;
    }
    else if (delta &lt; 365 * 24 * 60 * 60 * 1000) {
        const months = Math.floor(delta / (30 * 24 * 60 * 60 * 1000));
        return `${months} month${months > 1 ? "s" : ""} ago`;
    }
    else {
        const years = Math.floor(delta / (365 * 24 * 60 * 60 * 1000));
        return `${years} year${years > 1 ? "s" : ""} ago`;
    }
}



export default DataTable;
</code></pre>
        </article>
    </section>




            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>


</body>
</html>
